using System.Collections.Generic;
using System.Linq;
using System;

#nullable enable

namespace roguelike.level;

public static class PrefabLibrary {
	public static readonly List<TilePrefab> tilePrefabs = [];

	static PrefabLibrary() {
		LoadPrefabs();
	}

	private static void LoadPrefabs() {
		string f = ((char)24).ToString();
		tilePrefabs.Add(new TilePrefab(
			"Circled Bathhouse",
			[
				"#############",
				"#...........#",
				"#.#.......#.#",
				"#...÷÷÷÷÷...#",
				"#..÷÷÷÷÷÷÷..#",
				"#..÷÷÷÷÷÷÷..#",
				"#..÷÷÷÷÷÷÷..#",
				"#...÷÷÷÷÷...#",
				"#.#.......#.#",
				"#...........#",
				"######.######",
			],
			[(6, 10)],
			["bath", "water", "ruins"]
		));
		tilePrefabs.Add(new TilePrefab(
			"Big Bathhouse",
			[
				"###############",
				"#÷÷÷÷÷÷÷÷÷÷÷÷÷#",
				"#÷÷÷÷÷÷÷÷÷÷÷÷÷#",
				"#÷÷÷÷÷÷÷÷÷÷÷÷÷#",
				"#÷÷÷÷÷÷÷÷÷÷÷÷÷#",
				"#÷÷÷÷÷÷÷÷÷÷÷÷÷#",
				"#÷÷÷÷÷÷÷÷÷÷÷÷÷#",
				"#.....÷÷÷.....#",
				"#...#.....#...#",
				"#.............#",
				"#######.#######",
			],
			[(7, 10)],
			["bath", "water", "ruins"]
		));
		tilePrefabs.Add(new TilePrefab(
			"Centered Bathhouse",
			[
				"#####.#####",
				"#.........#",
				"#.#.....#.#",
				"#...÷÷÷...#",
				"#..÷÷÷÷÷..#",
				"...÷÷÷÷÷...",
				"#..÷÷÷÷÷..#",
				"#...÷÷÷...#",
				"#.#.....#.#",
				"#.........#",
				"#####.#####",
			],
			[(5, 10), (5, 0), (0, 5), (10, 5)],
			["bath", "water"]
		));
		tilePrefabs.Add(new TilePrefab(
			"Lawfully Wild Temple",
			[
				"#############",
				"#...........#",
				"#..#..è..#..#",
				"#...........#",
				"#...........#",
				"#...........#",
				"#..#.....#..#",
				"#...........#",
				"#...........#",
				"#...........#",
				"#..#.....#..#",
				"#...........#",
				"######.######",
			],
			[(6, 12)],
			["temple", "olympians", "wild"]
		));
		tilePrefabs.Add(new TilePrefab(
			"Hidden Warriors Temple",
			[
				"#############",
				"#...........#",
				"#...........#",
				"#.....è.....#",
				"#...........#",
				"#...........#",
				"#..#..#..#..#",
				"#...........#",
				"#..#..#..#..#",
				"#...........#",
				"##.###.####.#",
			],
			[(6, 10), (6, 0), (0, 5), (12, 5)],
			["temple", "warriors", "olympians"]
		));
		tilePrefabs.Add(new TilePrefab(
			"Big Temple",
			[
				"######.######",
				"#...........#",
				"#..#..#..#..#",
				"#...........#",
				"#...........#",
				"#...........#",
				"......è......",
				"#...........#",
				"#...........#",
				"#...........#",
				"#..#..#..#..#",
				"#...........#",
				"######.######",
			],
			[(6, 12)],
			["temple", "olympians", "wild", "warriors", "underworld"]
		));
		tilePrefabs.Add(new TilePrefab(
			"Big Villa",
			[
				"###################",
				"#........#........#",
				"#####....#........#",
				"#...#....#######.##",
				"#...#.............#",
				"#...#.........##.##",
				"#...#.........#...#",
				"#...#.........#...#",
				"#...#.........#...#",
				"#######..#######.##",
				"#.....#..#........#",
				"#.....#..#........#",
				"#######..##########",
			],
			[(6, 12)],
			["villa", "big"]
		));
		tilePrefabs.Add(new TilePrefab(
			"House One",
			[
				"###################",
				"#...#.........#...#",
				"#...#.........#...#",
				"#.................#",
				"#...#.........#...#",
				"##.####..#######.##",
				"#.....#..#........#",
				"#.....#..#........#",
				"#######..##########",
			],
			[(6, 12)],
			["house", "small"]
		));
		tilePrefabs.Add(new TilePrefab(
			"House two",
			[
				"###################",
				$"#....#.{f},,{f},,.#.....#",
				$"#......,{f},,{f},.......#",
				$"#....#.,,,{f},,.#.....#",
				$"#......,,{f},{f},.......#",
				$"#....#.,{f},,,{f}.#.....#",
				"###.###############",
				"#.................#",
				"#.................#",
				"#.................#",
				"#...#.........#...#",
				"##.####..#######.##",
				"#.....#..#........#",
				"#.....#..#........#",
				"#######..##########",
			],
			[(7, 14)],
			["house", "big", "backyard"]
		));
		tilePrefabs.Add(new TilePrefab(
			"Garden Villa",
			[
				"####################",
				"#..................#",
				"#..................#",
				"#....##########....#",
				"##..##........##..##",
				$"#....#.{f},,{f},,.#....#",
				$"#......,{f},,{f},......#",
				$"#....#.,,,{f},,.#....#",
				$"#......,,{f},{f},......#",
				$"#....#.,{f},,,{f}.#....#",
				"#..................#",
				"####.####...###.####",
				"#......#.....#.....#",
				"#......#.....#.....#",
				"#########...########",
			],
			[(10, 14)],
			["villa", "big", "garden"]
		));
		tilePrefabs.Add(new TilePrefab(
			"Center Catacombs",
			[
				"########...########",
				"#..0.#.......#.0..#",
				"#....#.......#....#",
				"####...........####",
				"#0......000......0#",
				"####...........####",
				"#.................#",
				"#..#..#.....#..#..#",
				"#.0#0.#.....#.0#0.#",
				"########...########",
			],
			[(8, 9)],
			["catacombs", "center"]
		));
		tilePrefabs.Add(new TilePrefab(
			"Room Catacombs",
			[
				"    ##### ##### #####    ",
				"    #.0.# #.0.# #.0.#    ",
				"    #...# #...# #...#    ",
				"######.#####.#####.##    ",
				"#...................#    ",
				"######..............#####",
				"#0.....................0#",
				"######..............#####",
				"#0..................#    ",
				"######..............#####",
				"#0.....................0#",
				"######..............#####",
				"#...................#    ",
				"#...................#    ",
				"########...##########    ",
			],
			[(12, 14)],
			["catacombs", "rooms"]
		));
		tilePrefabs.Add(new TilePrefab(
			"Inn Big",
			[
				"#########################",
				"#.......................#",
				"#.......................#",
				"#.......................#",
				"###.###################.#",
				"#.....#....#.........#..#",
				"#..........#...,,,,,.#..#",
				"#.....#....#...,,,,,.#..#",
				"#.....#....#...,,,,,.#..#",
				"#.....#........,,,,,.#..#",
				"#.....#....#...,,,,,.#..#",
				"#.....#....#...,,,,,.#..#",
				"############..###########",
			],
			[(6, 12)],
			["inn", "big", "garden"]
		));
		tilePrefabs.Add(new TilePrefab(
			"Inn Big",
			[
				"#########################",
				"#.......................#",
				"#.......................#",
				"#.......................#",
				"###.###################.#",
				"#.....#....#.........#..#",
				"#..........#...,,,,,.#..#",
				"#.....#....#...,,,,,.#..#",
				"#.....#....#...,,,,,.#..#",
				"#.....#........,,,,,.#..#",
				"#.....#....#...,,,,,.#..#",
				"#.....#....#...,,,,,.#..#",
				"############..###########",
			],
			[(12, 12)],
			["inn", "big", "garden"]
		));
		tilePrefabs.Add(new TilePrefab(
			"Inn big with baths",
			[
				"##########################",
				"#......#.............#...#",
				"#......#..÷÷÷÷÷÷÷÷÷..#...#",
				"#####.##..÷÷÷÷÷÷÷÷÷..#####",
				"#.........÷÷÷÷÷÷÷÷÷..#...#",
				"#.........÷÷÷÷÷÷÷÷÷..#...#",
				"#.........÷÷÷÷÷÷÷÷÷..#####",
				"#.........................",
				"#######..########..#######",
				"#.....#...#....#...#.....#",
				"###.###...##..##...###.###",
				"#........................#",
				"#######..÷÷÷÷÷÷÷÷..#######",
				"#........÷÷÷÷÷÷÷÷........#",
				"#.....#..÷÷÷÷÷÷÷÷..#.....#",
				"#######..÷÷÷÷÷÷÷÷..#######",
				"#.....#..÷÷÷÷÷÷÷÷..#.....#",
				"#........................#",
				"########.##....##.########",
				"#.........#....#.........#",
				"#.........#....#.........#",
				"############..############",
			],
			[(12, 21), (25, 8)],
			["inn", "big", "baths"]
		));
}

	public static TilePrefab? GetRandomByTag(string tag) {
		Random random = new Random();
		List<TilePrefab> filtered = tilePrefabs.Where(p => p.tags.Contains(tag)).ToList();
		return filtered.Count > 0 ? filtered[random.Next(0, filtered.Count)] : null;
	}
}